/*!
 * (C) Ionic http://ionicframework.com - MIT License
 */
import{d as n}from"./p-7b30edcc.js";import{OVERLAY_BACK_BUTTON_PRIORITY as e,shoudUseCloseWatcher as o}from"./p-ceceac26.js";import{b as t,c as i}from"./p-5d7e32ce.js";import{C as a}from"./p-a3f572a7.js";import{c as d,f as r,a as s,b as l,g as c}from"./p-b5839dc2.js";import{p as u}from"./p-06fee233.js";let m=0,p=0;const v=new WeakMap,f=n=>({create:e=>C(n,e),dismiss:(e,o,t)=>B(document,e,o,n,t),getTop:async()=>E(document,n)}),h=f("ion-alert"),b=f("ion-action-sheet"),w=f("ion-loading"),y=f("ion-modal"),g=f("ion-picker"),k=f("ion-popover"),x=f("ion-toast"),j=n=>{"undefined"!=typeof document&&P(document);const e=m++;n.overlayIndex=e},O=n=>(n.hasAttribute("id")||(n.id="ion-overlay-"+ ++p),n.id),C=(n,e)=>"undefined"!=typeof window&&void 0!==window.customElements?window.customElements.whenDefined(n).then((()=>{const o=document.createElement(n);return o.classList.add("overlay-hidden"),Object.assign(o,Object.assign(Object.assign({},e),{hasController:!0})),z(document).appendChild(o),new Promise((n=>d(o,n)))})):Promise.resolve(),D='[tabindex]:not([tabindex^="-"]):not([hidden]):not([disabled]), input:not([type=hidden]):not([tabindex^="-"]):not([hidden]):not([disabled]), textarea:not([tabindex^="-"]):not([hidden]):not([disabled]), button:not([tabindex^="-"]):not([hidden]):not([disabled]), select:not([tabindex^="-"]):not([hidden]):not([disabled]), .ion-focusable:not([tabindex^="-"]):not([hidden]):not([disabled]), .ion-focusable[disabled="false"]:not([tabindex^="-"]):not([hidden])',T=(n,e)=>{let o=n.querySelector(D);const t=null==o?void 0:o.shadowRoot;t&&(o=t.querySelector(D)||o),o?r(o):e.focus()},A=(n,e)=>{const o=Array.from(n.querySelectorAll(D));let t=o.length>0?o[o.length-1]:null;const i=null==t?void 0:t.shadowRoot;i&&(t=i.querySelector(D)||t),t?t.focus():e.focus()},P=n=>{0===m&&(m=1,n.addEventListener("focus",(e=>{((n,e)=>{const o=E(e,"ion-alert,ion-action-sheet,ion-loading,ion-modal,ion-picker,ion-popover"),t=n.target;o&&t&&(o.classList.contains("ion-disable-focus-trap")||(o.shadowRoot?(()=>{if(o.contains(t))o.lastFocus=t;else{const n=o.lastFocus;T(o,o),n===e.activeElement&&A(o,o),o.lastFocus=e.activeElement}})():(()=>{if(o===t)o.lastFocus=void 0;else{const n=c(o);if(!n.contains(t))return;const i=n.querySelector(".ion-overlay-wrapper");if(!i)return;if(i.contains(t)||t===n.querySelector("ion-backdrop"))o.lastFocus=t;else{const n=o.lastFocus;T(i,o),n===e.activeElement&&A(i,o),o.lastFocus=e.activeElement}}})()))})(e,n)}),!0),n.addEventListener("ionBackButton",(o=>{const t=E(n);(null==t?void 0:t.backdropDismiss)&&o.detail.register(e,(()=>{t.dismiss(void 0,q)}))})),o()||n.addEventListener("keydown",(e=>{if("Escape"===e.key){const e=E(n);(null==e?void 0:e.backdropDismiss)&&e.dismiss(void 0,q)}})))},B=(n,e,o,t,i)=>{const a=E(n,t,i);return a?a.dismiss(e,o):Promise.reject("overlay does not exist")},M=(n,e)=>((n,e)=>(void 0===e&&(e="ion-alert,ion-action-sheet,ion-loading,ion-modal,ion-picker,ion-popover,ion-toast"),Array.from(n.querySelectorAll(e)).filter((n=>n.overlayIndex>0))))(n,e).filter((n=>!n.classList.contains("overlay-hidden"))),E=(n,e,o)=>{const t=M(n,e);return void 0===o?t[t.length-1]:t.find((n=>n.id===o))},G=(n=!1)=>{const e=z(document).querySelector("ion-router-outlet, ion-nav, #ion-view-container-root");e&&(n?e.setAttribute("aria-hidden","true"):e.removeAttribute("aria-hidden"))},I=async(e,o,a,d,r)=>{var s,l;if(e.presented)return;G(!0),void 0!==n&&M(n).forEach((n=>n.setAttribute("aria-hidden","true"))),e.presented=!0,e.willPresent.emit(),null===(s=e.willPresentShorthand)||void 0===s||s.emit();const c=t(e),u=e.enterAnimation?e.enterAnimation:i.get(o,"ios"===c?a:d);await F(e,u,e.el,r)&&(e.didPresent.emit(),null===(l=e.didPresentShorthand)||void 0===l||l.emit()),"ION-TOAST"!==e.el.tagName&&L(e.el),!e.keyboardClose||null!==document.activeElement&&e.el.contains(document.activeElement)||e.el.focus(),e.el.removeAttribute("aria-hidden")},L=async n=>{let e=document.activeElement;if(!e)return;const o=null==e?void 0:e.shadowRoot;o&&(e=o.querySelector(D)||e),await n.onDidDismiss(),null!==document.activeElement&&document.activeElement!==document.body||e.focus()},V=async(e,o,a,d,r,s,l)=>{var c,u,m;if(!e.presented)return!1;void 0!==n&&1===M(n).length&&G(!1),e.presented=!1;try{e.el.style.setProperty("pointer-events","none"),e.willDismiss.emit({data:o,role:a}),null===(c=e.willDismissShorthand)||void 0===c||c.emit({data:o,role:a});const n=t(e),m=e.leaveAnimation?e.leaveAnimation:i.get(d,"ios"===n?r:s);a!==H&&await F(e,m,e.el,l),e.didDismiss.emit({data:o,role:a}),null===(u=e.didDismissShorthand)||void 0===u||u.emit({data:o,role:a}),(v.get(e)||[]).forEach((n=>n.destroy())),v.delete(e),e.el.classList.add("overlay-hidden"),e.el.style.removeProperty("pointer-events"),void 0!==e.el.lastFocus&&(e.el.lastFocus=void 0)}catch(n){console.error(n)}return e.el.remove(),void 0!==n&&(null===(m=E(n))||void 0===m||m.removeAttribute("aria-hidden")),!0},z=n=>n.querySelector("ion-app")||n.body,F=async(n,e,o,t)=>{o.classList.remove("overlay-hidden");const a=e(n.el,t);n.animated&&i.getBoolean("animated",!0)||a.duration(0),n.keyboardClose&&a.beforeAddWrite((()=>{const n=o.ownerDocument.activeElement;(null==n?void 0:n.matches("input,ion-input, ion-textarea"))&&n.blur()}));const d=v.get(n)||[];return v.set(n,[...d,a]),await a.play(),!0},N=(n,e)=>{let o;const t=new Promise((n=>o=n));return S(n,e,(n=>{o(n.detail)})),t},S=(n,e,o)=>{const t=i=>{l(n,e,t),o(i)};s(n,e,t)},W=n=>"cancel"===n||n===q,$=n=>n(),_=(n,e)=>{if("function"==typeof n)return i.get("_zoneGate",$)((()=>{try{return n(e)}catch(n){throw n}}))},q="backdrop",H="gesture",J=39,K=n=>{let e,o=!1;const t=a(),i=(i=!1)=>{if(e&&!i)return{delegate:e,inline:o};const{el:a,hasController:d,delegate:r}=n;return o=null!==a.parentNode&&!d,e=o?r||t:r,{inline:o,delegate:e}};return{attachViewToDom:async e=>{const{delegate:o}=i(!0);if(o)return await o.attachViewToDom(n.el,e);const{hasController:t}=n;if(t&&void 0!==e)throw new Error("framework delegate is missing");return null},removeViewFromDom:()=>{const{delegate:e}=i();e&&void 0!==n.el&&e.removeViewFromDom(n.el.parentElement,n.el)}}},Q=()=>{let n;const e=()=>{n&&(n(),n=void 0)};return{addClickListener:(o,t)=>{e();const i=void 0!==t?document.getElementById(t):null;i?n=((n,e)=>{const o=()=>{e.present()};return n.addEventListener("click",o),()=>{n.removeEventListener("click",o)}})(i,o):u(`A trigger element with the ID "${t}" was not found in the DOM. The trigger element must be in the DOM when the "trigger" property is set on an overlay component.`,o)},removeClickListener:e}};export{q as B,H as G,J as O,h as a,b,k as c,K as d,Q as e,I as f,V as g,N as h,W as i,j,O as k,w as l,y as m,T as n,E as o,g as p,_ as s,x as t}